<?xml version="1.0"?>

<build subject="removing" stage="05" chroot="yes">

	<phase seq="1">
	
		<entry type="script/bash" seq="1">
			<action when="after" seq="1">
				<line>echo -e "Removing unnecessary files...\n"</line>
				
				<line verbose="yes">rm -f $PROJECT__RFS/usr/lib/lib{bfd,opcodes}.a</line>
				<line verbose="yes">rm -f $PROJECT__RFS/usr/lib/libbz2.a</line>
				<line verbose="yes">rm -f $PROJECT__RFS/usr/lib/lib{com_err,e2p,ext2fs,ss}.a</line>
				<line verbose="yes">rm -f $PROJECT__RFS/usr/lib/libltdl.a</line>
				<line verbose="yes">rm -f $PROJECT__RFS/usr/lib/libfl.a</line>
				<line verbose="yes">rm -f $PROJECT__RFS/usr/lib/libfl_pic.a</line>
				<line verbose="yes">rm -f $PROJECT__RFS/usr/lib/libz.a</line>
				
				<line verbose="yes">rm -rf $PROJECT__RFS/usr/share/man/* /usr/share/groff/* /usr/share/info/*</line>
				<line verbose="yes">rm -rf $PROJECT__RFS/usr/share/lintian/* /usr/share/linda/* /var/cache/man/*</line>
				
				<line verbose="yes">rm -rf $PROJECT__RFS/tmp/*</line>
				
				<line verbose="yes">rm -rf $PROJECT__RFS/build</line>
				<line verbose="yes">rm -rf $PROJECT__RFS/packages</line>
			</action>
		    
			<action when="after" seq="2">
				<line>echo -e "\n\nUnmounting filesystem...\n"</line>
				
				<line>set +e</line>
				
				<line verbose="yes">umount -v $PROJECT__RFS/dev/pts</line>
				<line verbose="yes">umount -v $PROJECT__RFS/dev</line>
				<line verbose="yes">umount -v $PROJECT__RFS/run</line>
				<line verbose="yes">umount -v $PROJECT__RFS/proc</line>
				<line verbose="yes">umount -v $PROJECT__RFS/sys</line>
				
				<line>set -e</line>
			</action>
			
			<action when="after" seq="3">
				<line verbose="yes">chown -R root:root $PROJECT__RFS</line>
				<line verbose="yes">chmod -R u+rwx $PROJECT__RFS</line>
				<line verbose="yes">chmod -R o-w $PROJECT__RFS</line>
			</action>
		</entry>
		
	</phase>
	
</build>

